{% extends "includes/templates/case-view-item.html" %}

{% block beforeContent %}
  {# {{ govukBackLink({
    text: "Back to " + (caseType | lower),
    href: formCancel
  }) }} #}

  {{ govukBreadcrumbs({
    items: [
      {
        text: "Case overview",
        href: "../../overview"
      },
      {
        text: "Supporting information",
        href: "../../documents"
      },
      {
        text: "Document"
      }
    ]
  }) }}

{% endblock %}

{# Todo: make this actually update a case #}
{% block pageContent %}


{% set pageHeading = currentDocument.title %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <span class="govuk-caption-l">{{currentDocument.type}}</span>
    <h1 class="govuk-heading-l">{{pageHeading}}</h1>

    {{metaArea | safe }}

    {% set summaryListData = [] %}

    {% for name, item in currentDocument %}
      {% if (item | length == 3) %}
        {% set item = item | arrayToGovukDate %}
      {% endif %}
      {% set row = [name | title, item] %}
      {% set summaryListData = summaryListData | push(row) %}
    {% endfor %}

    {{ govukSummaryList({
      rows: summaryListData | arrayToSummaryList
    }) }}


  </div>


  {% if currentDocument.hasFile == 'yes' %}

    {# Create a fake filename #}
    {% set fileExtension = 'pdf' if currentDocument.correspondenceType != 'Email' else 'msg' %}

    {% set fileLink %}
      <a href="" class="govuk-link">{{currentDocument.dateAdded | arrayToDateObject | formatDate("dashDate")}}_{{currentDocument.title | slugify}}.{{fileExtension}}</a>
    {% endset %}

    <div class="govuk-grid-column-one-third">
      <h2 class="govuk-heading-m">Attachments</h2>
      <div class="app-document-preview">
        <p class="govuk-body">{{fileLink | safe}}</p>
        <div class="mspsds-attachment-panel__image">
          <a href="/public/images/document-thumbnail.png">
            <img src="/public/images/document-thumbnail.png" alt="document preview">
          </a>
        </div>
      </div>
    </div>

  {% endif %}


</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    {{editDeleteLinks | safe }}

    {# {{returnButton | safe }} #}
  </div>
</div>

{% endblock %}
